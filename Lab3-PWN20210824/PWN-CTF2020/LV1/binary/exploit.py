import socket
import readline

host = '127.0.0.1'
port = 9000
#host = '120.114.62.211'
#port =  2117

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

def recv(info=None):
  # TODO
  res = s.recv(4096)
  print(f'[<] {info if info else ""}')
  print(res.decode('ascii'))
  return res

def send(data):
  # TODO
  data = data + b'\n' if data[-1] != b'\n' else data
  s.send(data)

def interact():
  for _ in range(100):
    cmd = input('> ').encode('ascii')
    send(cmd)
    recv()

# stage 1
ans = 0x1 | 0x100000
recv()
recv()
send(str(ans).encode('ascii'))
recv()

# stage 2
ans = f'{0x64} {0x100} {0xfaceb00c}'
recv()
recv()
send(ans.encode('ascii'))
recv()

# stage 3
ans = f'{0x60107c}'
recv()
recv()
send(ans.encode('ascii'))
recv()
recv()

recv()
recv()
recv()
#interact()
send(b'cat flag')
recv()
recv()
