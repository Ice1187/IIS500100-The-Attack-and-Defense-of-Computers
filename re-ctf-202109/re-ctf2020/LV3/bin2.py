from pwn import *

context.arch = 'amd64'

asm_flag = b'\x48\xb8\xb5\xa3\xb9\xb1\xc6\x41\x41\x41\x50\x48\xb8\xbc\xa0\xa9\x93\xaa\xa3\xbe\x93\x50\x48\xb8\xa9\x93\xa5\xbf\x93\xbf\xa5\xa1\x50\x48\xb8\xbf\xa4\xa9\xa0\xa0\xaf\xa3\xa8\x50\x48\xb8\x8d\x85\x9f\xff\xb7\xa3\xa7\x93\x50\x48\x89\xe6\x48\x31\xd2\x80\x34\x16\xcc\xfe\xc2\x80\xfa\x25\x75\xf5\x48\x31\xc0\x48\xff\xc0\x48\x89\xc7\x0f\x05\x6a\x3c\x58\x48\x31\xff\x0f\x05'

sh = disasm(asm_flag)

print(sh)

hex_flag = [
  0x414141c6b1b9a3b5,
  0x93bea3aa93a9a0bc,
  0xa1a5bf93bfa593a9,
  0xa8a3afa0a0a9a4bf,
  0x93a7a3b7ff9f858d
]

# xor with 0xcc

print(f'hex flag: {hex_flag}')

flag = b''
for f in hex_flag[::-1]:
	f = f ^ 0xcccccccccccccccc
	flag += f.to_bytes(8, 'little')

print(f'Flag: {flag[:-4]}')
